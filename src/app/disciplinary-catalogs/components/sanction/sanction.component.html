<div nz-row nzJustify="space-around">
  <div nz-col nzFlex="auto">
      <h1>Sanciones</h1>
  </div>
</div>

<!-- Create cycle modal -->
<nz-modal [(nzVisible)]="isVisible" nzTitle="Crear sanción" [nzContent]="modalContent" nzOkText="Guardar"
    nzCancelText="Cancelar" [nzFooter]="modalFooter" (nzOnOk)="handleOk()" (nzOnCancel)="handleCancel()">
    <!-- Modal content -->
    <form nz-form [formGroup]="sanctionForm">
        <ng-template #modalContent>
            <nz-form-item nzJustify="space-around">
                <nz-form-label nzRequired>Nombre</nz-form-label>
                <nz-form-control [nzSpan]="16" [nzErrorTip]="errorTpl">
                    <div nz-row class="form">
                    <input nz-input formControlName="name" placeholder="Nombre de la sanción" />
                    <ng-template #errorTpl let-control>
                        <ng-container *ngIf="control.hasError('required')">
                            El nombre es requerido. <br>
                        </ng-container>
                        <ng-container *ngIf="control.hasError('pattern')">
                            El nombre debe contener solo letras. <br>
                        </ng-container>
                        <ng-container *ngIf="control.hasError('maxlength')">
                            El nombre debe contener máximo 32 caracteres.
                        </ng-container>
                    </ng-template>
                  </div>

                </nz-form-control>
                <nz-form-label nzRequired>Descripción</nz-form-label>
                <nz-form-control [nzSpan]="16" [nzErrorTip]="errorTplTwo">
                  <div nz-row>
                  <textarea rows="4" nz-input formControlName="description" placeholder="Descripción de la sanción"></textarea>
                    <ng-template #errorTplTwo let-control>
                        <ng-container *ngIf="control.hasError('required')">
                            La descripción es requerida. <br>
                        </ng-container>
                        <ng-container *ngIf="control.hasError('maxlength')">
                            El nombre debe contener máximo 256 caracteres.
                        </ng-container>
                    </ng-template>
                  </div>
                </nz-form-control>
            </nz-form-item>
        </ng-template>
    </form>
    <!-- Modal footer -->
    <ng-template #modalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Cancelar</button>
        <button nz-button nzType="primary" (click)="handleOk()" [nzLoading]="isConfirmLoading">Guardar</button>
    </ng-template>
</nz-modal>

<div nz-row nzJustify="center">
    <div nz-col nzXs="24" nzSm="24" nzMd="20" nzLg="16" nzXl="12">
      <div class="search-bar" nz-row nzJustify="space-between" [nzGutter]="[10, 10]">

        <div nz-col>
          <label>Nombre: </label>
          <nz-input-group [nzSuffix]="inputClearUsername">
              <input nz-input [(ngModel)]="searchValue" placeholder="Buscar usuario" />
          </nz-input-group>
          <ng-template #inputClearUsername>
              <i nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle" *ngIf="searchValue" (click)="searchValue = null; search()"></i>
          </ng-template>
        </div>
        <div nz-col nzFlex="110px">
          <a nz-button nzType="primary" (click)="showModal()">Crear sanción</a>
      </div>
        <div class="search" nz-col>
          <button nz-button nzType="primary" (click)="search()">Buscar</button>
        </div>
      </div>
      <!-- Sanctions table -->
      <div class="sanctions" nz-row>
        <div nz-col>
          <nz-spin nzTip="Cargando ..." [nzSpinning]="loading">
            <nz-table #filterTable
                      nzTableLayout="fixed"
                      [nzSize]="tableSize"
                      [nzData]="listOfDisplayData"
                      [nzFrontPagination]="false"
                      [nzTotal]="pagination.totalItems"
                      [nzPageSize]="pagination.perPage"
                      [nzPageIndex]="pagination.page"
                      (nzQueryParams)="recharge($event)"
            >
              <thead>
              <tr>
                <th nzColumnKey="name" [nzSortFn]="true">Nombre</th>
                <th>Descripción</th>
                <th>Acción</th>
              </tr>
              </thead> 
              <tbody>
                <tr *ngFor="let data of filterTable.data">
                  <td>{{ data.name }}</td>
                  <td>{{ data.description }}</td>
                  <td>
                                <span>
                                    <a nz-tooltip nzTooltipTitle="Ver">
                                        <i nz-icon nzType="eye" nzTheme="outline"></i>
                                    </a>
                                    <nz-divider nzType="vertical"></nz-divider>
                                </span>
    
                    <span>
                                    <!--
                                    <a nz-tooltip nzTooltipTitle="Actualizar">
                                        <i nz-icon nzType="edit" nzTheme="outline" (click)="AllowEditing(data)"></i>
                                    </a>
                                    <nz-divider nzType="vertical"></nz-divider>-->
                                    <a nz-tooltip nzTooltipTitle="Eliminar"  (click)="showConfirm(data.id, data.name, data.description)">
                                        <i nz-icon nzType="delete" nzTheme="outline"></i>
                                    </a>
                                </span>
                  </td>
                </tr>
                </tbody>
              </nz-table>
            </nz-spin>
        </div>
      </div>
    </div> 
</div>