<div nz-row nzJustify="space-around">
  <div nz-col nzFlex="auto">
      <h1>Sanciones</h1>
  </div>
</div>

<!-- Create cycle modal -->
<nz-modal [(nzVisible)]="isVisible" nzTitle="Crear sanción" [nzContent]="modalContent" nzOkText="Guardar"
    nzCancelText="Cancelar" [nzFooter]="modalFooter" (nzOnOk)="handleOk()" (nzOnCancel)="handleCancel()">
    <!-- Modal content -->
    <form nz-form [formGroup]="sanctionForm">
        <ng-template #modalContent>
            <nz-form-item nzJustify="space-around">
                <nz-form-label nzRequired>Nombre</nz-form-label>
                <nz-form-control [nzSpan]="16" [nzErrorTip]="errorTpl">
                    <div nz-row class="form">
                    <input nz-input formControlName="name" placeholder="Nombre de la sanción" />
                    <ng-template #errorTpl let-control>
                        <ng-container *ngIf="control.hasError('required')">
                            El nombre es requerido. <br>
                        </ng-container>
                        <ng-container *ngIf="control.hasError('pattern')">
                            El nombre debe contener solo letras. <br>
                        </ng-container>
                        <ng-container *ngIf="control.hasError('maxlength')">
                            El nombre debe contener máximo 128 caracteres.
                        </ng-container>
                    </ng-template>
                  </div>

                </nz-form-control>
                <nz-form-label nzRequired>Descripción</nz-form-label>
                <nz-form-control [nzSpan]="16" [nzErrorTip]="errorTplTwo">
                  <div nz-row>
                  <textarea rows="6" nz-input formControlName="description" placeholder="Descripción de la sanción"></textarea>
                    <ng-template #errorTplTwo let-control>
                        <ng-container *ngIf="control.hasError('required')">
                            La descripción es requerida. <br>
                        </ng-container>
                        <ng-container *ngIf="control.hasError('maxlength')">
                            El nombre debe contener máximo 256 caracteres.
                        </ng-container>
                    </ng-template>
                  </div>
                </nz-form-control>
            </nz-form-item>
        </ng-template>
    </form>
    <!-- Modal footer -->
    <ng-template #modalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Cancelar</button>
        <button nz-button nzType="primary" (click)="handleOk()" [nzLoading]="isConfirmLoading">Guardar</button>
    </ng-template>
</nz-modal>

<!--Sanction searcher an create button-->
<div nz-row nzJustify="space-between">
      <div nz-col nzSpan="6">
         <nz-input-group nzSearch [nzAddOnAfter]="suffixIconButton">
             <input type="text" nz-input placeholder="Buscar sanción" [(ngModel)]="searchValue"/>
         </nz-input-group>
         <ng-template #suffixIconButton>
              <button nz-button nzType="{{color}}" nzSearch (click)="search()"><i nz-icon nzType="{{icon}}"></i></button>
         </ng-template> 
      </div>
      <div nz-col>
             <a nz-button nzType="primary" *ngIf="checkPermission(28)" (click)="showModal()">Crear sanción</a>
      </div>
</div>

<!--Table-->
<div nz-row >
      <div class="sanctions" nz-row>
        <div nz-col>
          <nz-spin nzTip="Cargando ..." [nzSpinning]="loading">
            <nz-table #filterTable
                      nzTableLayout="fixed"
                      [nzSize]="tableSize"
                      [nzData]="listOfDisplayData"
                      [nzFrontPagination]="false"
                      [nzTotal]="pagination.totalItems"
                      [nzPageSize]="pagination.perPage"
                      [nzPageIndex]="pagination.page"
                      (nzQueryParams)="recharge($event)"
            >
              <thead>
              <tr>
                <th nzColumnKey="name" [nzSortFn]="true">Nombre</th>
                <th >Descripción</th>
                <th *ngIf="checkPermission(28)" [nzAlign]="'center'">Acción</th>
              </tr>
              </thead> 
              <tbody>
                <tr *ngFor="let data of filterTable.data">
                  <td>{{ data.name }}</td>
                  <td>{{ data.description }}</td>
                  <td  [nzAlign]="'center'">    
                                <span>
                                    <a nz-tooltip *ngIf="checkPermission(28)" nzTooltipTitle="Actualizar">
                                        <i nz-icon nzType="edit" nzTheme="outline" (click)="AllowEditing(data)"></i>
                                    </a>
                                    <nz-divider *ngIf="checkPermission(28)" nzType="vertical"></nz-divider>
                                    <a nz-tooltip nzTooltipTitle="Eliminar" *ngIf="checkPermission(28)"  (click)="showConfirm(data.id, data.name, data.description)">
                                        <i nz-icon nzType="delete" nzTheme="outline"></i>
                                    </a>
                                </span>
                  </td>
                </tr>
                </tbody>
              </nz-table>
            </nz-spin>
        </div>
    </div> 
</div>