<div nz-row nzJustify="space-between">
    <div nz-col>
        <h1>Sesiones de consejería</h1>
    </div>
</div>

<div nz-row [nzGutter]="[10, 10]">
    <!-- Code -->
    <div nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="6" nzXl="6">
        <label>NIE: </label>
        <nz-input-group [nzSuffix]="inputClearCode">
            <input nz-input [(ngModel)]="searchStudentParams.code" placeholder="Buscar NIE" />
        </nz-input-group>
        <ng-template #inputClearCode>
            <i nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle" *ngIf="searchStudentParams.code" (click)="searchStudentParams.code = null; getSessions(null)"></i>
        </ng-template>
    </div>

    <!-- Name -->
    <div nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="6" nzXl="6">
        <label>Nombre: </label>
        <nz-input-group [nzSuffix]="inputClearName">
            <input nz-input [(ngModel)]="searchStudentParams.firstname" placeholder="Buscar nombre" />
        </nz-input-group>
        <ng-template #inputClearName>
            <i nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle" *ngIf="searchStudentParams.firstname" (click)="searchStudentParams.firstname = null; getSessions(null)"></i>
        </ng-template>
    </div>

    <!-- Lastname -->
    <div nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="6" nzXl="6">
        <label>Apellido: </label>
        <nz-input-group [nzSuffix]="inputClearLastname">
            <input nz-input [(ngModel)]="searchStudentParams.lastname" placeholder="Buscar apellido" />
        </nz-input-group>
        <ng-template #inputClearLastname>
            <i nz-icon class="ant-input-clear-icon" nzTheme="fill" nzType="close-circle" *ngIf="searchStudentParams.lastname" (click)="searchStudentParams.lastname = null; getSessions(null)"></i>
        </ng-template>
    </div>

    <!-- Shift -->
    <div nz-col nzXs="24" nzSm="12" nzMd="12" nzLg="6" nzXl="6">
        <label>Turno: </label>
        <nz-input-group>
            <nz-select class="shift" nzShowSearch nzAllowClear nzPlaceHolder="Seleccionar turno"
                [(ngModel)]="searchStudentParams.currentShift.id" (ngModelChange)="cleanGradesSelect($event);">
                <nz-option *ngFor="let shift of shifts" [nzLabel]="shift.name" [nzValue]="shift.id"></nz-option>
            </nz-select>
        </nz-input-group>
    </div>

    <!-- Grade -->
    <div nz-col nzXs="24" nzSm="12" nzMd="12" nzLg="6" nzXl="6">
        <label>Grado: </label>
        <nz-input-group>
            <nz-select class="grade" nzShowSearch nzAllowClear nzPlaceHolder="Seleccionar grado"
                [(ngModel)]="searchStudentParams.grade.id" (ngModelChange)="getSessions(null)">
                <nz-option *ngFor="let grade of grades" [nzLabel]="grade.name" [nzValue]="grade.id"></nz-option>
            </nz-select>
        </nz-input-group>
    </div>

    <!-- Registered at -->
    <div nz-col nzXs="24" nzSm="24" nzMd="18" nzLg="12" nzXl="6">
        <label>Fecha: </label>
        <nz-input-group>
            <nz-range-picker nzFormat="dd/MM/yyyy" [ngModel]="searchSessionParams.registeredAt"
                [nzDisabledDate]="disabledDate" (ngModelChange)="onChangeDatePicker($event)"></nz-range-picker>
        </nz-input-group>
    </div>

    <!-- Search button-->
    <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="4" nzXl="4">
      <div class="btn-container" nz-row nzAlign="bottom" nzJustify="end">
        <button nz-button nzType="primary" (click)="getSessions(null)">Buscar</button>
      </div>
    </div>
</div>

<div nz-row>
    <div nz-col nzSpan="24">
        <nz-spin nzTip="Cargando ..." [nzSpinning]="loading">
            <nz-table #filterTable
                [nzData]="listOfDisplayData"
                nzTableLayout="fixed"
                [nzFrontPagination]="false"
                [nzTotal]="pagination.totalItems"
                [nzPageSize]="pagination.perPage"
                [nzPageIndex]="pagination.page"
                nzSize="small"
                (nzQueryParams)="getSessions($event)"
            >
                <thead>
                    <tr>
                        <th nzColumnKey="code" [nzSortFn]="true" [nzSortPriority]="1">NIE</th>
                        <th nzColumnKey="firstname" [nzSortFn]="true" [nzSortPriority]="2">Nombres</th>
                        <th nzColumnKey="lastname" [nzSortFn]="true" [nzSortPriority]="3">Apellidos</th>
                        <th nzColumnKey="currentShift" [nzSortFn]="true" [nzSortPriority]="4">Turno</th>
                        <th nzColumnKey="currentGrade" [nzSortFn]="true" [nzSortPriority]="5">Grado</th>
                        <th nzColumnKey="sessionDate" [nzSortFn]="true" [nzSortPriority]="6">Última consejería</th>
                        <th [nzAlign]="'center'">Acción</th>
                    </tr>
                </thead>

                <tbody>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td [nzAlign]="'center'">
                            <a [routerLink]="['/estudiantes', 0, 'detalle']">
                                Perfil
                            </a>
                            <nz-divider nzType="vertical"></nz-divider>
                            <a>Expediente</a>
                            <nz-divider nzType="vertical"></nz-divider>
                            <a [routerLink]="['/sesiones', 0]">Sesiones</a>
                        </td>
                    </tr>
                    <tr *ngFor="let data of filterTable.data">
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td [nzAlign]="'center'">
                            <a [routerLink]="['/estudiantes', 0, 'detalle']">
                                Perfil
                            </a>
                            <nz-divider nzType="vertical"></nz-divider>
                            <a>Expediente</a>
                            <nz-divider nzType="vertical"></nz-divider>
                            <a>Sesiones</a>
                        </td>
                    </tr>
                </tbody>
            </nz-table>
        </nz-spin>
    </div>
</div>